<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Психогео OpenLayers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no, maximum-scale=1, minimum-scale=1" />
  <!-- OpenLayers CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.3.0/ol.css" />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Ваши стили (если есть) -->
  <link rel="stylesheet" href="style.css" />
  <!-- <script src="https://unpkg.com/feather-icons"></script> -->
  <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/3.0.0/uicons-solid-straight/css/uicons-solid-straight.css'>
</head>

<body class="relative h-screen overflow-hidden">
  <!-- Карта (на весь экран) -->
  <div id="map" class="fixed inset-0 z-0"></div>
  </div>

  <!-- Нижняя панель -->
  <div id="bottomSheet" class="fixed left-0 right-0 bottom-0 z-50 bg-white rounded-t-2xl shadow-xl max-h-[80vh] transition-all duration-300">
    <!-- Язычок -->
    <div id="dragHandle" class="w-14 h-2 bg-gray-300 rounded-full mx-auto mt-3 cursor-pointer"></div>

    <!-- Кнопка "Моё положение" -->
<button id="locateBtn"
      class="absolute right-4 bottom-[calc(100%+10px)] z-10 bg-white border border-gray-300 shadow-lg rounded-full p-3 flex items-center justify-center hover:bg-indigo-100 transition"
      title="Определить моё местоположение">
      <span class="text-indigo-600">
  <svg xmlns="http://www.w3.org/2000/svg"
       viewBox="0 0 24 24"
       class="w-6 h-6 fill-current">
    <!-- fill="currentColor" говорит: брать цвет из CSS color -->
    <path fill="currentColor"
          d="M21.949,11c-.471-4.717-4.232-8.479-8.949-8.949V0h-2V2.051C6.283,2.521,2.521,6.283,2.051,11H0v2H2.051c.471,4.717,4.232,8.479,8.949,8.949v2.051h2v-2.051c4.717-.471,8.479-4.232,8.949-8.949h2.051v-2h-2.051Zm-9.949,6c-2.757,0-5-2.243-5-5s2.243-5,5-5,5,2.243,5,5-2.243,5-5,5Zm3-5c0,1.654-1.346,3-3,3s-3-1.346-3-3,1.346-3,3-3,3,1.346,3,3Z"/>
  </svg>
</span>
    </button>


    <!-- 1) Форма настроек -->
    <div id="formContainer" class="sheet-view" data-view="main">
      <div class="content overflow-y-auto px-4 pb-4 max-h-[calc(80vh-10px)] space-y-4">
       
       
        <!-- Цель -->
        <div class="relative">
          <label for="purpose" class="block font-semibold text-gray-700 mb-1 flex items-center">
    Цель
    <button type="button" class="ml-1 info-btn text-blue-500 " data-info="purpose" title="Подробнее про Цель">
      <!-- небольшая иконка i -->
      <i class="fi fi-ss-interrogation"></i>
    </button>
  </label>
         
          <input id="purpose" type="text" placeholder="Опиши намерение..."
            class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400 outline-none transition" />
        </div>

        <!-- Тип точки -->
        <div class="relative">
          <label class="block font-semibold text-gray-700 mb-1 flex items-center">
    Тип точки
    <button type="button" class="ml-1 info-btn text-blue-500" data-info="pointType" title="Подробнее про Тип точки">
      <i class="fi fi-ss-interrogation"></i>
    </button>
  </label>
          <div class="flex gap-3 mb-2">
            <button type="button" data-value="random"
              class="point-btn px-4 py-2 rounded-lg border border-indigo-400 bg-indigo-50 text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              Случайная
            </button>
            <button type="button" data-value="attractor"
              class="point-btn px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              Аттрактор
            </button>
            <button type="button" data-value="void"
              class="point-btn px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              Пустота
            </button>
          </div>

        </div>

        <!-- Радиус -->
        <div>
          <label for="radius" class="block font-semibold text-gray-700 mb-1">Радиус поиска</label>
          <div class="flex items-center gap-3 mb-2">
            <button type="button" data-value="1"
              class="radius-btn px-4 py-2 rounded-lg border border-indigo-400 bg-indigo-50 text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              1 км
            </button>
            <button type="button" data-value="3"
              class="radius-btn px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              3 км
            </button>
            <button type="button" data-value="5"
              class="radius-btn px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              5 км
            </button>
            <input
    id="radius"
    type="text"
    inputmode="decimal"
    pattern="^\\d+([.,]\\d+)?$"
    placeholder="Свой км"
    class="w-24 ml-3 border rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400 outline-none transition"
/>
          </div>
        </div>

        <!-- API -->
        <div class="relative">
          <label for="apiKey" class="block font-semibold text-gray-700 mb-1 flex items-center">
          API
          <button type="button" class="ml-1 info-btn text-blue-500" data-info="apiKey" title="Подробнее про API">
            <i class="fi fi-ss-interrogation"></i>
         </button>
          </label>
          
         <div class="relative w-full">
  <input
    id="apiKey"
    type="password"
    inputmode="decimal"
    placeholder="Введите API ключ..."
    class="w-full pr-10 border rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400 outline-none transition"
  />
  <button id="toggleApiVisibility" type="button"
          class="absolute inset-y-0 right-3 flex items-center text-gray-500 hover:text-gray-700"
          tabindex="-1">
    <i id="toggleIcon" class="fi fi-ss-eye w-5 h-5"></i>
  </button>
</div>
</div>

        <!-- Кнопка Создать точку -->
        <div>
          <button id="createPointBtn" disabled
            class="w-full bg-indigo-600 text-white rounded-lg py-2 font-semibold text-lg shadow hover:bg-indigo-700 transition disabled:opacity-50">
            Создать точку
          </button>
        </div>
      </div>
    </div>

    <!-- инфо-поп-ап -->
 <div id="infoOverlay" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-70">
  <div id="infoModal"
       class="bg-white rounded-lg shadow-xl max-w-md w-11/12 p-4 relative flex flex-col space-y-4">
    <button id="infoClose"
      class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">
      <i class="fi fi-ss-cross"></i>
    </button>
    <h2 id="infoTitle" class="text-lg font-semibold mb-2"></h2>
    <p id="infoText" class="text-gray-700"></p>
  </div>
</div>


    <!-- 2) Результат генерации -->
    <div id="resultContainer" class="sheet-view px-4 pt-4 pb-4 space-y-4" data-view="result" hidden>
      <div id="resultContent"></div>
      <button id="newPointBtn"
        class="mt-4 w-full bg-indigo-600 text-white rounded-lg py-2 font-semibold hover:bg-indigo-700 transition">
        Новая генерация
      </button>
    </div>

    <!-- 3) Сводка (summary) -->
<div id="summaryContainer" class="sheet-view px-4 py-4" data-view="summary" hidden>
  <div id="summarySnippet"
       class="bg-indigo-50 rounded-xl p-4 space-y-2 shadow text-gray-800 text-base">
  </div>
</div>
  </div>

  <!-- Скрипт ES Modules -->
  <script type="module" src="js/main.js"></script>
  <!-- OpenLayers JS -->
  <script src="https://cdn.jsdelivr.net/npm/ol@v7.3.0/dist/ol.js"></script>
</body>
</html>
