<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Психогео OpenLayers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no, maximum-scale=1, minimum-scale=1" />
  <!-- OpenLayers CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.3.0/ol.css" />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Ваши стили (если есть) -->
  <link rel="stylesheet" href="style.css" />
</head>

<body class="relative h-screen overflow-hidden">
  <!-- Карта (на весь экран) -->
  <div id="map" class="absolute inset-0 z-0">
    <!-- Кнопка "Моё положение" -->
    <button id="locateBtn"
      class="absolute top-4 right-4 z-10 bg-white border border-gray-300 shadow-lg rounded-full p-3 flex items-center justify-center hover:bg-indigo-100 transition"
      title="Определить моё местоположение">
      <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="4" />
        <path d="M12 2v2m0 16v2m10-10h-2M4 12H2" />
      </svg>
    </button>
  </div>

  <!-- Нижняя панель -->
  <div id="bottomSheet" class="fixed left-0 right-0 bottom-0 z-50 bg-white rounded-t-2xl shadow-xl max-h-[80vh] transition-all duration-300">
    <!-- Язычок -->
    <div id="dragHandle" class="w-14 h-2 bg-gray-300 rounded-full mx-auto mt-3 cursor-pointer"></div>

    <!-- 1) Форма настроек -->
    <div id="formContainer" class="sheet-view" data-view="main">
      <div class="content overflow-y-auto px-4 pb-4 max-h-[calc(80vh-10px)] space-y-4">
        <!-- Цель -->
        <div>
          <label for="purpose" class="block font-semibold text-gray-700 mb-1">Цель</label>
          <div class="text-sm text-gray-500 mb-1">
            Опиши своё намерение или вопрос, который хочешь исследовать во время прогулки.
          </div>
          <input id="purpose" type="text" placeholder="Опиши намерение..."
            class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400 outline-none transition" />
        </div>

        <!-- Тип точки -->
        <div>
          <label class="block font-semibold text-gray-700 mb-1">Тип точки</label>
          <div class="flex gap-3 mb-2">
            <button type="button" data-value="random"
              class="point-btn px-4 py-2 rounded-lg border border-indigo-400 bg-indigo-50 text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              Случайная
            </button>
            <button type="button" data-value="attractor"
              class="point-btn px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              Аттрактор
            </button>
            <button type="button" data-value="void"
              class="point-btn px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              Пустота
            </button>
          </div>
          <div id="pointTypeHelp" class="text-sm text-gray-600">Абсолютно случайное место в выбранном радиусе.</div>
        </div>

        <!-- Радиус -->
        <div>
          <label for="radius" class="block font-semibold text-gray-700 mb-1">Радиус поиска</label>
          <div class="flex items-center gap-3 mb-2">
            <button type="button" data-value="1"
              class="radius-btn px-4 py-2 rounded-lg border border-indigo-400 bg-indigo-50 text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              1 км
            </button>
            <button type="button" data-value="3"
              class="radius-btn px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              3 км
            </button>
            <button type="button" data-value="5"
              class="radius-btn px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 transition hover:bg-indigo-50 focus:outline-none focus:ring-0">
              5 км
            </button>
            <input id="radius" type="number" min="0.1" step="0.1" placeholder="Свой км"
              class="w-24 ml-3 border rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400 outline-none transition" />
          </div>
        </div>

        <!-- API -->
        <div>
          <label for="apiKey" class="block font-semibold text-gray-700 mb-1">API</label>
          <div class="text-sm text-gray-500 mb-1">
            Для работы обязательно нужен <span class="font-semibold">личный API-ключ</span>.
            Если его нет, <a href="https://quantumnumbers.anu.edu.au/" target="_blank" class="text-indigo-600 underline">зарегистрируйтесь на ANU Quantum Numbers</a>.
          </div>
          <input id="apiKey" type="text" placeholder="Введите API ключ..."
            class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-400 outline-none transition" />
          <div id="apiWarning" class="text-red-600 text-sm mt-1 hidden">
            Пожалуйста, введите корректный API-ключ.
          </div>
        </div>

        <!-- Кнопка Создать точку -->
        <div>
          <button id="createPointBtn" disabled
            class="w-full bg-indigo-600 text-white rounded-lg py-2 font-semibold text-lg shadow hover:bg-indigo-700 transition disabled:opacity-50">
            Создать точку
          </button>
        </div>
      </div>
    </div>

    <!-- 2) Результат генерации -->
    <div id="resultContainer" class="sheet-view px-4 pb-4" data-view="result" hidden>
      <div id="resultContent"></div>
      <button id="newPointBtn"
        class="mt-4 w-full bg-indigo-600 text-white rounded-lg py-2 font-semibold hover:bg-indigo-700 transition">
        Новая генерация
      </button>
    </div>
  </div>

  <!-- Скрипт ES Modules -->
  <script type="module" src="js/main.js"></script>
  <!-- OpenLayers JS -->
  <script src="https://cdn.jsdelivr.net/npm/ol@v7.3.0/dist/ol.js"></script>
</body>
</html>
